(function(e){function t(t){for(var s,o,i=t[0],u=t[1],l=t[2],p=0,d=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(s in u)Object.prototype.hasOwnProperty.call(u,s)&&(e[s]=u[s]);c&&c(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],s=!0,i=1;i<r.length;i++){var u=r[i];0!==n[u]&&(s=!1)}s&&(a.splice(t--,1),e=o(o.s=r[0]))}return e}var s={},n={app:0},a=[];function o(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=s,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(r,s,function(t){return e[t]}.bind(null,s));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var c=u;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var s=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},a=[],o=r("2877"),i={},u=Object(o["a"])(i,n,a,!1,null,null,null),l=u.exports,c=r("8c4f"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("layout",[r("div",{staticClass:"ui text container"},[r("h1",{staticClass:"ui header"},[e._v("Добро пожаловать в подслушано")]),r("div",{staticClass:"ui one column grid"},[r("div",{staticClass:"column"},[r("h3",[e._v("Сервис для анонимного общения")]),r("img",{staticClass:"ui small image",attrs:{src:e.publicPath+"olen.jpeg"}})])])])])},d=[],m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"ui inverted segment"},[r("div",{staticClass:"ui inverted secondary menu"},[r("a",{staticClass:"active item",attrs:{href:"/"}},[e._v(" Главная ")]),r("a",{staticClass:"active item",attrs:{href:"/feed"}},[e._v("Последние посты")]),e.loggedIn?e._e():r("a",{staticClass:"active item",attrs:{href:"/login"}},[e._v("Войти")]),e.loggedIn?e._e():r("a",{staticClass:"active item",attrs:{href:"/register"}},[e._v("Зарегистрироваться")]),e.loggedIn?r("a",{staticClass:"active item",attrs:{href:"/home"}},[e._v("Моя страница")]):e._e(),r("div",{staticClass:"right menu"},[r("a",{staticClass:"ui active item",attrs:{href:"#"},on:{click:e.logout}},[e._v(" Выйти ")])])])]),e._t("default")],2)},v=[],h={computed:{loggedIn:function(){return null!=this.$store.state.user},user:function(){return this.$store.state.user}},methods:{logout:function(){this.$store.commit("logout")}}},f=h,g=Object(o["a"])(f,m,v,!1,null,null,null),b=g.exports,x={components:{Layout:b},data:function(){return{publicPath:"/"}}},_=x,w=Object(o["a"])(_,p,d,!1,null,null,null),k=w.exports,C=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("layout",[null!==e.error&&e.errorVisible?r("sui-message",{staticClass:"ui error message",attrs:{content:e.error,dismissable:""},on:{dismiss:e.handleDismiss}}):e._e(),r("div",{staticClass:"ui text container"},[r("div",{staticClass:"ui one column grid"},[r("div",{staticClass:"column"},[r("h1",{staticClass:"ui header"},[e._v("Регистрация")])])]),r("div",{staticClass:"ui text container"},[r("form",{staticClass:"ui form",attrs:{method:"post",action:""},on:{submit:e.register}},[r("div",{staticClass:"field"},[r("label",[e._v("Email / логин")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",required:"",name:"email",placeholder:"username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),r("div",{staticClass:"field"},[r("label",[e._v("Пароль")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",required:"",name:"password",placeholder:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),r("button",{staticClass:"ui button",attrs:{type:"submit"}},[e._v("Submit")])])])])],1)},O=[],y=(r("96cf"),r("1da1")),P={components:{Layout:b},methods:{register:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.preventDefault(),r.prev=1,r.next=4,t.$http.post("register",{login:t.username,password:t.password});case 4:s=r.sent,t.$store.commit("login",{user:s.data.user}),t.$router.push({name:"Home"})["catch"]((function(){})),r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](1),t.error=r.t0.response.data.error,t.errorVisible=!0;case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))()},handleDismiss:function(){this.errorVisible=!1}},data:function(){return{username:null,password:null,error:null,errorVisible:!0}}},j=P,R=Object(o["a"])(j,C,O,!1,null,null,null),$=R.exports,V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("layout",[null!==e.error&&e.errorVisible?r("sui-message",{staticClass:"ui error message",attrs:{content:e.error,dismissable:""},on:{dismiss:e.handleDismiss}}):e._e(),r("div",{staticClass:"ui text container"},[r("div",{staticClass:"ui one column grid"},[r("div",{staticClass:"column"},[r("h1",{staticClass:"ui header"},[e._v("Войти")])])]),r("div",{staticClass:"ui text container"},[r("form",{staticClass:"ui form",attrs:{method:"post",action:""},on:{submit:e.register}},[r("div",{staticClass:"field"},[r("label",[e._v("Email / логин")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",required:"",name:"email",placeholder:"username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),r("div",{staticClass:"field"},[r("label",[e._v("Пароль")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",required:"",name:"password",placeholder:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),r("button",{staticClass:"ui button",attrs:{type:"submit"}},[e._v("Submit")])])])])],1)},S=[],D={components:{Layout:b},methods:{register:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.preventDefault(),r.prev=1,r.next=4,t.$http.post("login",{login:t.username,password:t.password});case 4:s=r.sent,t.$store.commit("login",{user:s.data.user}),t.$router.push({name:"Home"})["catch"]((function(){})),r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](1),t.error=r.t0.response.data.error,t.errorVisible=!0;case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))()},handleDismiss:function(){this.errorVisible=!1}},data:function(){return{username:null,password:null,error:null,errorVisible:!0}}},E=D,N=Object(o["a"])(E,V,S,!1,null,null,null),L=N.exports,U=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("layout",[null!==e.error&&e.errorVisible?r("sui-message",{staticClass:"ui error message",attrs:{content:e.error,dismissable:""},on:{dismiss:e.handleDismiss}}):e._e(),r("div",{staticClass:"ui text container"},[r("p",[e._v("Добро пожаловать домой, "+e._s(this.$store.state.user))]),r("p",[e._v("Добавьте новую запись:")]),r("form",{staticClass:"ui form",attrs:{method:"post",action:""},on:{submit:e.save}},[r("div",{staticClass:"field"},[r("label",[e._v("Текст: ")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],staticStyle:{width:"30%"},attrs:{required:"",rows:"3",name:"content",placeholder:"Some text"},domProps:{value:e.content},on:{input:function(t){t.target.composing||(e.content=t.target.value)}}})]),r("div",{staticClass:"field"},[r("sui-checkbox",{attrs:{label:"Опубликовать",toggle:""},model:{value:e.expose,callback:function(t){e.expose=t},expression:"expose"}})],1),r("button",{staticClass:"ui button",attrs:{type:"submit"}},[e._v("Сохранить")])])]),r("br"),r("div",{staticClass:"ui text container"},[r("p",[e._v("Ваши посты: ")]),e._l(e.posts,(function(t){return r("div",{key:t[0],staticClass:"ui info message"},[r("p",[e._v("Текст: "+e._s(t[2]))]),r("p",[e._v("Сохранено:: "+e._s(new Date(1e3*t[4]).toLocaleString()))]),r("sui-checkbox",{attrs:{label:"Опубликовано",disabled:""},model:{value:t[3],callback:function(r){e.$set(t,3,r)},expression:"post[3]"}}),t[3]?e._e():r("div",[r("sui-button",{nativeOn:{click:function(r){return e.getToken(t[0])}}},[e._v("Поделиться")]),r("sui-button",{nativeOn:{click:function(r){return e.openEdit(t[0])}}},[e._v("Редактировать")])],1)],1)})),r("sui-button",{attrs:{content:"Предыдущие",disabled:0===e.pageNum,icon:"left arrow","label-position":"right"},on:{click:e.prevPage}}),r("sui-button",{attrs:{content:"Следующие",disabled:e.lastPage,icon:"right arrow","label-position":"left"},on:{click:e.nextPage}})],2),r("sui-modal",{model:{value:e.modalOpen,callback:function(t){e.modalOpen=t},expression:"modalOpen"}},[r("sui-modal-header",[e._v("Поделиться")]),r("sui-modal-content",[r("router-link",{attrs:{to:{name:"Shared",params:{token:e.token}}}},[e._v("Отправьте эту ссылку вашему другу, чтобы поделиться с ним записью ")])],1),r("sui-modal-actions",[r("sui-button",{attrs:{positive:""},nativeOn:{click:function(t){return e.toggle(t)}}},[e._v(" OK ")])],1)],1),r("sui-modal",{attrs:{id:"editModal"},model:{value:e.edit.modal,callback:function(t){e.$set(e.edit,"modal",t)},expression:"edit.modal"}},[r("sui-modal-header",[e._v("Редактировать пост: "+e._s(e.edit.post_id))]),null!==e.error&&e.errorVisible?r("sui-message",{staticClass:"ui error message",attrs:{content:e.error,dismissable:""},on:{dismiss:e.handleDismiss}}):e._e(),r("sui-modal-content",[r("form",{staticClass:"ui form",attrs:{method:"post",action:""},on:{submit:e.editPost}},[r("div",{staticClass:"field"},[r("label",[e._v("Текст: ")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.post_text,expression:"edit.post_text"}],staticStyle:{width:"30%"},attrs:{required:"",rows:"3",name:"content",placeholder:"Some text"},domProps:{value:e.edit.post_text},on:{input:function(t){t.target.composing||e.$set(e.edit,"post_text",t.target.value)}}})]),r("div",{staticClass:"field"},[r("sui-checkbox",{attrs:{label:"Опубликовать",toggle:""},model:{value:e.edit.post_publish,callback:function(t){e.$set(e.edit,"post_publish",t)},expression:"edit.post_publish"}})],1),r("button",{staticClass:"ui button",attrs:{type:"submit"}},[e._v("Сохранить")])])])],1)],1)},q=[],I=(r("4160"),r("0d03"),r("d3b7"),r("25f0"),r("159b"),{components:{Layout:b},data:function(){return{content:null,expose:null,publicPath:"/",error:null,errorVisible:!0,pageNum:0,lastPage:!1,posts:[],modalOpen:!1,token:null,edit:{modal:!1,post_id:null,post_text:"",post_publish:!1}}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getUserPosts();case 2:case"end":return t.stop()}}),t)})))()},methods:{save:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.preventDefault(),s="false",t.expose&&(s="true"),r.prev=3,r.next=6,t.$http.post("posts",{text:t.content,publish:s});case 6:t.getUserPosts(),r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](3),t.error=r.t0.response.data.error,t.errorVisible=!0;case 13:case"end":return r.stop()}}),r,null,[[3,9]])})))()},getUserPosts:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("posts/user?paginate[limit]=5&paginate[offset]="+(5*e.pageNum).toString());case 3:r=t.sent,e.posts=r.data.posts,e.lastPage=e.posts.length<5,e.posts.forEach((function(e){e[3]=!e[3]})),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),e.error=t.t0.response.data.error,e.errorVisible=!0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},getToken:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$http.get("posts/".concat(e,"/token"));case 3:s=r.sent,t.token=s.data.token[0],t.toggle(),r.next=12;break;case 8:r.prev=8,r.t0=r["catch"](0),t.error=r.t0.response.data.error,t.errorVisible=!0;case 12:case"end":return r.stop()}}),r,null,[[0,8]])})))()},nextPage:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pageNum++,t.next=3,e.getUserPosts();case 3:case"end":return t.stop()}}),t)})))()},prevPage:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pageNum--,t.next=3,e.getUserPosts();case 3:case"end":return t.stop()}}),t)})))()},handleDismiss:function(){this.errorVisible=!1},toggle:function(){this.modalOpen=!this.modalOpen},openEdit:function(e){var t=this;this.edit.post_id=e,this.posts.forEach((function(r){r[0]===e&&(t.edit.post_text=r[2],t.edit.post_publish=r[3])})),this.toggleEdit()},toggleEdit:function(){this.edit.modal=!this.edit.modal},editPost:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.preventDefault(),s="false",t.edit.post_publish&&(s="true"),r.prev=3,r.next=6,t.$http.patch("posts/".concat(t.edit.post_id),{text:t.edit.post_text,publish:s});case 6:return t.toggleEdit(),r.next=9,t.getUserPosts();case 9:r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](3),t.error=r.t0.response.data.error,t.errorVisible=!0;case 15:case"end":return r.stop()}}),r,null,[[3,11]])})))()}}}),M=I,T=Object(o["a"])(M,U,q,!1,null,null,null),H=T.exports,J=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("layout",[null!==e.error&&e.errorVisible?r("sui-message",{staticClass:"ui error message",attrs:{content:e.error,dismissable:""},on:{dismiss:e.handleDismiss}}):e._e(),r("div",{staticClass:"ui text container"},[r("p",[e._v("Последние записи: ")]),e._l(e.posts,(function(t){return r("div",{key:t[0],staticClass:"ui info message"},[r("p",[e._v("Текст: "+e._s(t[2]))]),r("p",[e._v("Написал "+e._s(t[1])+" "+e._s(new Date(1e3*t[4]).toLocaleString()))])])})),r("sui-button",{attrs:{content:"Предыдущие",disabled:0===e.pageNum,icon:"left arrow","label-position":"right"},on:{click:e.prevPage}}),r("sui-button",{attrs:{content:"Следующие",disabled:e.lastPage,icon:"right arrow","label-position":"left"},on:{click:e.nextPage}})],2)],1)},F=[],K={components:{Layout:b},data:function(){return{pageNum:0,lastPage:!1,posts:[],error:null,errorVisible:!1}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getPosts();case 2:case"end":return t.stop()}}),t)})))()},methods:{getPosts:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("posts/latest?paginate[limit]=10&paginate[offset]="+(10*e.pageNum).toString());case 3:r=t.sent,console.log(r.data),e.posts=r.data.posts,e.lastPage=e.posts.length<10,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),e.error=t.t0.response.data.error,e.errorVisible=!0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},nextPage:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pageNum++,t.next=3,e.getPosts();case 3:case"end":return t.stop()}}),t)})))()},prevPage:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pageNum--,t.next=3,e.getPosts();case 3:case"end":return t.stop()}}),t)})))()},handleDismiss:function(){this.errorVisible=!1}}},z=K,A=Object(o["a"])(z,J,F,!1,null,null,null),B=A.exports,G=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("layout",[null!==e.error&&e.errorVisible?r("sui-message",{staticClass:"ui error message",attrs:{content:e.error,dismissable:""},on:{dismiss:e.handleDismiss}}):e._e(),null!==e.post?r("div",{staticClass:"ui text container"},[r("div",{staticClass:"ui info message"},[r("p",[e._v("Пост пользователя "+e._s(e.post[1]))]),r("p",[e._v("Текст: "+e._s(e.post[2]))]),r("p",[e._v("Сохранено: "+e._s(new Date(1e3*e.post[4]).toLocaleString()))])])]):e._e()],1)},Q=[],W={components:{Layout:b},data:function(){return{post:null,error:null,errorVisible:!1}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getPost();case 2:case"end":return t.stop()}}),t)})))()},methods:{getPost:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=e.$route.params.token,t.next=4,e.$http.get("posts/token",{params:{token:r}});case 4:s=t.sent,e.post=s.data,t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),e.error=t.t0.response.data.error,e.errorVisible=!0;case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},handleDismiss:function(){this.errorVisible=!1}}},X=W,Y=Object(o["a"])(X,G,Q,!1,null,null,null),Z=Y.exports;s["a"].use(c["a"]);var ee=[{path:"/",name:"Index",component:k},{path:"/register",name:"Register",component:$},{path:"/login",name:"Login",component:L},{path:"/home",name:"Home",component:H},{path:"/feed",name:"Feed",component:B},{path:"/shared/:token",name:"Shared",component:Z}],te=new c["a"]({mode:"history",base:"/",routes:ee}),re=te,se=r("2f62"),ne=r("0e44");s["a"].use(se["a"]);var ae=new se["a"].Store({state:{},mutations:{login:function(e,t){e.user=t.user},logout:function(e){e.user=null}},actions:{},modules:{},plugins:[Object(ne["a"])()]}),oe=r("080a"),ie=r.n(oe),ue="";ue=window.location.origin;var le=ue,ce="".concat(le,"/api"),pe=r("bc3a"),de=r.n(pe);de.a.defaults.baseURL=ce,de.a.defaults.withCredentials=!0,s["a"].prototype.$http=de.a,ae.$http=de.a,s["a"].config.productionTip=!1,s["a"].use(ie.a),new s["a"]({router:re,store:ae,render:function(e){return e(l)}}).$mount("#app")}});
//# sourceMappingURL=app.833c6177.js.map